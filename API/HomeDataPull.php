<?php 	$username="drup197";	 	$password="bandit20";		$database="drup197";		$server="localhost"; 		$link = mysqli_connect($server,$username,$password,$database); 		//@mysql_select_db($database,$link) or die( "Unable to select database"); 		$query = " 				SELECT wfc.sid, wfc.name, wfc.description, wfc.app_indicator, f.filename, AVG(c.rating) as average 							FROM dr_webform_views_add_lti_content_9 wfc 								LEFT JOIN dr_file_managed f on f.fid = wfc.display_image                				LEFT JOIN LTIComments c on c.LTIKey = wfc.sid								GROUP BY wfc.sid, wfc.name, wfc.description, f.filename				ORDER BY wfc.name						 ";			 	$result = mysqli_query($link,$query); 	if(!$result)  die( "Query: " . $query . "\nError:" . mysql_error() ); 	    $tableData = '{"aaData": [[';    $count = 0;    while(($row = mysqli_fetch_array($result)) != null){	//print_r($row);		if($count == 0){ 			$Letter = substr($row['name'],0,1);			$tableData .= '"<div class=\"letterHead\"><h2>' . strtoupper($Letter) . 					'</h2></div>","<div class=\"letterHead\"><h2>&nbsp;</h2></div>","<div class=\"letterHead\"><h2>&nbsp;</h2></div>"' . 					',"<div class=\"letterHead\"><h2>&nbsp;</h2></div>"],[';			$count = 1;		}		if(strcasecmp(substr($row['name'],0,1),$Letter) == 0){ 	    		if($count == 5){				$tableData .= '],[' . formatData($row);				$count = 2;			}else{				if($count != 1) $tableData .= ',';				$tableData .= formatData($row);				$count++;			} 	 	}else{			if($count != 5){				for($i=0; $i<5-$count; $i++){					$tableData .= ',""';				}			}				$Letter = substr($row['name'],0,1);				$tableData .= '],["<div class=\"letterHead\"><h2><h2>' . strtoupper($Letter) . 						'</h2></div>","<div class=\"letterHead\"><h2>&nbsp;</h2></div>","<div class=\"letterHead\"><h2>&nbsp;</h2></div>"' . 						',"<div class=\"letterHead\"><h2>&nbsp;</h2></div>"],[' . formatData($row);				$count = 2;					}     	 }    	if($count != 5){		for($i=0; $i<5-$count; $i++){			$tableData .= ',""';		}	}	$tableData .= ']]}';    	echo $tableData;		function formatData($rowArray){ 				if($rowArray){     					if($rowArray['filename'] != "")  								$table = '"<a href=\"?q=instructor_preview&sid=' . $rowArray['sid'] . '\"><img width=\"200px\" height=\"200px\" src=\"http://68.2.131.105:8080/drupal/sites/'                        						. 'default/files/webform/Form_displaypics/' . $rowArray['filename'] . '\" alt=\"No Image\"><br/>';								else $table = '"<a href=\"?q=instructor_preview&sid=' . $rowArray['sid'] . '\"><img width=\"200px\" height=\"200px\" src=\"http://68.2.131.105:8080/drupal/Uploaded'                        						. '/Images/thumbnail_default.png\" alt=\"No Image\"><br/>'; 	        			if($rowArray['name'] != "") $table .= $rowArray['name'] . isPaid($rowArray['app_indicator']) . '</a><br/>';								else $table .= isPaid($rowArray['app_indicator']) . 'No Name</a><br/>';						if($rowArray['average'] != "") $table .= formatRating($rowArray['average'],$rowArray['sid']);								else $table .= '<i>No Rating...</i><br/><br/>';            			if($rowArray['description'] != "") $table .= $rowArray['description'] . '"';								else $table .= 'No description"'; 				}						else{ 		    			$table ='" "'; 				} 				return $table;		}    	function formatRating($star,$id){        		$return = '<table id=\"starTable\" border=\"0\" width=\"90px\"><tr>';				$starCheck = true;        		for($i=1; $i<6; $i++){									if($starCheck)				$return .= '<td width=\"18px\"><div id=\"displayStar\"></div></td>';			else				$return .= '<td width=\"18px\"><div id=\"displayStarOff\"></div></td>';        		if((int)$i == (int)round($star))			$starCheck = false;		}				$return .= '</tr></table>';	return $return;    	}		function isPaid($paid){		$return = '  ';		if((String)$paid != 'Free')			$return = '&nbsp;<img height=\"17px\" width=\"15px\" src=\"/drupal/API/img/dollar-sign.png\" alt=\"paid\">';				return $return;	}  ?>